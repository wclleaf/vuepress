---
title: 进阶模式
date: 2025-09-01 15:30:18
permalink: /pages/610c83/
categories:
  - 项目
  - 井字棋
tags:
  - 
---
::: center
![tictactoe-advance](https://lhost.oss-cn-chengdu.aliyuncs.com/blog/tictactoe-advance.gif)
:::
在普通模式的基础上添加棋子数量限制即可，修改代码如下：
* 定义数组缓存双方已下棋子，达到4颗时清除第一颗
* 最先下的棋子添加动画标识
```vue
<script setup>
import { ref, computed } from 'vue'
const chessboard = ref([])
const player = ref('X')

const chessX = ref([])
const chessO = ref([])

const itemClass = computed(() => {
  return (item, idx) => {
    return { 
      'chesspiece--x': item === 'X', 
      'chesspiece--o': item === 'O', 
      'chesspiece--none': item === '',
      'chesspiece--x-anim': player.value === 'X' && item === 'X' && chessX.value.length == 3 && chessX.value[0] === idx,
      'chesspiece--o-anim': player.value === 'O' && item === 'O' && chessO.value.length == 3 && chessO.value[0] === idx,
    }
  }
})

// 落子
const playChess = (index) => {
  if (chessboard.value[index] === '') {
    chessboard.value[index] = player.value
    if (player.value === 'X') {
      chessX.value.push(index)
      if (chessX.value.length > 3) {
        const last = chessX.value.shift()
        chessboard.value[last] = ''
      }
    } else {
      chessO.value.push(index)
      if (chessO.value.length > 3) {
        const last = chessO.value.shift()
        chessboard.value[last] = ''
      }
    }
    player.value = player.value === 'X' ? 'O' : 'X'
    const winner = isWin()
    if (winner) {
      alert(`Player ${winner} wins!`)
      initBoard()
    }
  }
}

// 检查游戏是否结束
const isWin = () => {
  // 固定八种获胜组合
  const winningCombinations = [
    [0, 1, 2],
    [3, 4, 5],
    [6, 7, 8],
    [0, 3, 6],
    [1, 4, 7],
    [2, 5, 8],
    [0, 4, 8],
    [2, 4, 6]
  ]
  for (const combination of winningCombinations) {
    const [a, b, c] = combination
    if (chessboard.value[a] && chessboard.value[a] === chessboard.value[b] && chessboard.value[a] === chessboard.value[c]) {
      return chessboard.value[a]
    }
  }
  return false
}

// 初始化棋盘
const initBoard = () => {
  chessboard.value = Array(9).fill('')
  player.value = 'X'
}

initBoard()

</script>

<template>
  <div class="tictactoe">
    <div class="chessboard">
      <div
        v-for="(item, index) in chessboard"
        :key="index"
        class="chesspiece"
        :class="itemClass(item, index)"
        @click="playChess(index)"
        :data-player="player"
      >
        
      </div>
    </div>
  </div>
</template>

<style scoped lang="scss">
.tictactoe {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background-color: #f5f5f5;
  .chessboard {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    .chesspiece {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 120px;
      height: 120px;
      border-radius: 10px;
      background: #78bec5;
      transition: all .3s;
      cursor: pointer;
      
      font-size: 70px;
      font-weight: bolder;
      color: white;
      text-shadow: 1px 1px 4px #ccc;
      &--none {
        &:hover {          
          background: #4f6d70;
        }
      }
      &--none[data-player="X"]:hover::after {
        content: '✖';
        color: rgb(201, 201, 201);
      }
      &--none[data-player="O"]:hover::after {
        content: '〇';
        color: rgb(201, 201, 201);
      }
      &--x {
        background: #DC685A;
        cursor: default;
        &::after {
          content: '✖';
          font-size: 70px;
          font-weight: bolder;
          color: white;
          text-shadow: 1px 1px 4px #ccc;
        }
      }
      &--o {
        background: #ECAF4F;
        cursor: default;
        &::after {
          content: '〇';
          font-size: 70px;
          font-weight: bolder;
          color: white;
          text-shadow: 1px 1px 4px #ccc;
        }
      }
      &--x-anim, &--o-anim {
        animation: chessAnim 1.5s ease-in-out infinite alternate;
      }
    }
  }
  .chessboard--x {
    .chesspiece {
      &:hover::after {
        content: '✖';
        font-size: 70px;
        font-weight: bolder;
        color: rgb(192, 192, 192);
      }
    }
  }
  .chessboard--o {
    .chesspiece {
      &:hover::after {
        content: '〇';
        font-size: 70px;
        font-weight: bolder;
        color: rgb(192, 192, 192);
      }
    }
  }
}

@keyframes chessAnim {
  0% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}
</style>

```