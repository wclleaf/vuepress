---
title: HbuilderX配置自定义打包环境
date: 2025-07-29 17:27:31
permalink: /pages/749556/
categories:
  - 前端
  - 工具
tags:
  - 
---
在web开发时，往往需要把一套代码编译到不同环境，在`webpack`等环境下我们可以通过设置不同环境变量来实现。但在使用`HbuilerX`开发时中我们只能借助该工具自带的打包环境进行打包不能自定义环境，不过`HbuilderX`也提供了自定义环境的相关配置，详情见[uniapp属性](https://uniapp.dcloud.net.cn/collocation/package.html)

以h5开发为例，在`package.json`中添加如下配置：
```json
{
	// xxx
	"uni-app": {
	    "scripts": {
	        "build:test": { 
	            "title":"测试环境",
	            "env": {
	                "UNI_PLATFORM": "h5",
									"CUSTOM_ENV": "test"
	             },
	            "define": { 
	                "H5-TEST": true 
	            }
	        },
					"build:prod": {
					    "title":"正式环境",
					    "env": {
					        "UNI_PLATFORM": "h5",
									"CUSTOM_ENV": "prod"
					     },
					    "define": { 
					        "H5-PROD": true 
					    }
					}
	    }    
	}
	// xxx
}
```
* 配置后可在菜单**发行>自定义发行**中找到上面配置的`测试环境`和`正式环境`菜单，点击即可打包
* 在`env`中配置对应的编译环境和自定义环境变量，`UNI_PLATFORM`是必须配置，其它项则会添加到`process.env`中，如上就可以使用`process.env.CUSTOM_ENV`获取自定义环境变量
* 在`define`中配置自定义编译常量，在代码中体现为`#ifdef H5-TEST ... #endif`

使用示例如下：
```js
// 模板语法中使用编译常量
<template>
	<!-- #ifdef H5-TEST -->
	<div></div>
	<!-- #endif -->
</template>

// js中使用编译常量
function func() {
	// #ifdef H5-TEST
	xxx
	// #endif
}

// js中使用自定义环境变量
let baseUrl = ''
if (process.env.CUSTOM_ENV) {
	baseUrl = ''
} else {}
```

::: tip
需注意
1、`package.json`中不允许使用注释
2、如果需要使用命令行进行不同环境变量配置和打包，请使用[uniapp cli项目](https://uniapp.dcloud.net.cn/quickstart-cli.html)
:::